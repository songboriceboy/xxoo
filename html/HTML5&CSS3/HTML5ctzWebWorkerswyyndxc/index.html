<!DOCTYPE html>

<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta name="description" content="android,ios" />
        <meta name="keywords" content="android,ios" />

        <title>叶小钗</title>
        <style type='text/css'>
            body {
                background-color: #CCC;
            }
        </style>
        <link rel="stylesheet" href="../../../css/bootstrap.css" />
    </head>

    <body>
        <div class="container">

            <h1>叶小钗</h1>

            <div class='navbar navbar-inverse'>
                <div class='navbar-inner nav-collapse' style="height: auto;">
                    <ul class="nav">
                              				<li><a href="http://songboriceboy.github.io/xxoo/html/blade/index.html">blade</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/css/index.html">css</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/index.html">HTML5&CSS3</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/javascript/index.html">javascript</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/Javaxx/index.html">Java学习</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/nodejs/index.html">nodejs</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/requirejs/index.html">requirejs</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/Webqd/index.html">Web前端</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/xxgw/index.html">学习感悟</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/gzdd/index.html">工作点滴</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/jkxx/index.html">接口学习</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/wfl/index.html">未分类</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/ydkf/index.html">移动开发</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/sjms/index.html">设计模式</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/mst/index.html">面试题</a></li>
    				                      </ul>
                </div>
            </div>

            <div id='content' class='row-fluid'>

                <div class='span9 main'>
				<div style="color:blue" align=center>【HTML5初探之WebWorkers】网页也能多线程</div><br><h1>导航</h1>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_8" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/16/3023912.html">【初探HTML5之使用新标签布局】用html5布局我的博客页！</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_7" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/16/3025240.html">【HTML5初探之form标签】解放表单验证、增加文件上传、集成拖放</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_6" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/17/3027220.html">【HTML5初探之绘制图像（上）】看我canvas元素引领下一代web页面</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_5" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/19/3029603.html">【HTML5初探之绘制图像（下）】看我canvas元素引领下一代web页面</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_4" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/19/3030702.html">【HTML5初探之多媒体元素】视频播放HTML5、Flash谁才是王道？</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_3" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/19/3031002.html">【HTML5初探之本地存储】如果没有数据库。。。</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_2" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/20/3032223.html">【HTML5初探之离线应用】如何打造零请求、无流量的网站？</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_1" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/20/3032548.html">【HTML5初探之通信API】跨域门槛不再高、数据推送不是梦</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_0" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/20/3032765.html">【HTML5初探之Web Workers】网页也能多线程</a></p>
<p><a id="CategoryEntryList1_EntryStoryList_Entries_TitleUrl_0" class="entrylistItemTitle" href="http://www.cnblogs.com/yexiaochai/archive/2013/04/20/3033049.html">【HTML5初探之Geolocation API】让我们来回去地理信息</a></p>
<p>&nbsp;</p>
<h1>前言</h1>
<p>Web Workers 是在HTML5中新增的，用来在web应用程序中实现后台处理的一种技术</p>
<p>在HTML4中，js创建的程序都是单线程的，如果花费时间比较长的话web界面就会长时间没有响应，最恶劣的情况还会跳出一个脚本提示框：</p>
<p>提示脚本运行时间过长，是否继续。。。。于是就引出了本文的主角：Web Workers API</p>
<p>使用这个API用户可以非常容易的创建在后台运行的线程，要创建后台程序很简单：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">var</span> worker = <span style="color: #0000ff;">new</span> Worker(<span style="color: #800000;">'</span><span style="color: #800000;">*.js</span><span style="color: #800000;">'</span><span style="color: #000000;">);
注意：后台线程是不能访问页面或者窗口对象的
可以通过发送消息和接受消息与后台线程传递数据：
worker.onmessage </span>=<span style="color: #000000;"> function (e) {};
worker.postMessage </span>= function (e) {};</pre>
</div>
<p>说一下求和：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://www.w3.org/1999/xhtml"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 6</span>         <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> calculate() {
</span><span style="color: #008080;"> 7</span>             <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> num </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #000000;">10000000000</span><span style="background-color: #f5f5f5; color: #000000;">;
</span><span style="color: #008080;"> 8</span>             <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> r </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">;
</span><span style="color: #008080;"> 9</span>             <span style="background-color: #f5f5f5; color: #0000ff;">for</span><span style="background-color: #f5f5f5; color: #000000;"> (</span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> i </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #000000;">1</span><span style="background-color: #f5f5f5; color: #000000;">; i </span><span style="background-color: #f5f5f5; color: #000000;">&lt;</span><span style="background-color: #f5f5f5; color: #000000;"> num; i</span><span style="background-color: #f5f5f5; color: #000000;">++</span><span style="background-color: #f5f5f5; color: #000000;">) {
</span><span style="color: #008080;">10</span> <span style="background-color: #f5f5f5; color: #000000;">                r </span><span style="background-color: #f5f5f5; color: #000000;">+=</span><span style="background-color: #f5f5f5; color: #000000;"> i;
</span><span style="color: #008080;">11</span> <span style="background-color: #f5f5f5; color: #000000;">            }
</span><span style="color: #008080;">12</span> <span style="background-color: #f5f5f5; color: #000000;">            alert(r);
</span><span style="color: #008080;">13</span> <span style="background-color: #f5f5f5; color: #000000;">        }
</span><span style="color: #008080;">14</span> <span style="background-color: #f5f5f5; color: #000000;">        calculate();
</span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">16</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">17</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">18</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">19</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p><img src="47519287913718.jpg" alt=""></p>
<p>于是我美丽的框给出来了。。。但使用web worker便不会：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://www.w3.org/1999/xhtml"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 6</span>         <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> worker </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #0000ff;">new</span><span style="background-color: #f5f5f5; color: #000000;"> Worker(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">c.js</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;"> 7</span> <span style="background-color: #f5f5f5; color: #000000;">        worker.onmessage </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> (e) {
</span><span style="color: #008080;"> 8</span> <span style="background-color: #f5f5f5; color: #000000;">            alert(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">和：</span><span style="background-color: #f5f5f5; color: #000000;">'</span> <span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;"> e.data);
</span><span style="color: #008080;"> 9</span> <span style="background-color: #f5f5f5; color: #000000;">        };
</span><span style="color: #008080;">10</span>         <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> calculate() {
</span><span style="color: #008080;">11</span>             <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> num </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #000000;">1000000</span><span style="background-color: #f5f5f5; color: #000000;">;
</span><span style="color: #008080;">12</span> <span style="background-color: #f5f5f5; color: #000000;">            worker.postMessage(num);
</span><span style="color: #008080;">13</span> <span style="background-color: #f5f5f5; color: #000000;">        }
</span><span style="color: #008080;">14</span> <span style="background-color: #f5f5f5; color: #000000;">        calculate();
</span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">16</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">17</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">18</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">19</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #000000;">onmessage = function (e) {
    var num = e.data;
    var r = 0;
    for (var i = 1; i </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;"> num</span><span style="color: #ff0000;">; i++) {
        r +</span><span style="color: #0000ff;">= i;
    </span><span style="color: #ff0000;">}
    postMessage(r);
}</span></pre>
</div>
<p><img src="15375635872446.jpg" alt=""></p>
<p>我有时候就在想，我没事干嘛计算那么大的数字啊。。。。。当然这是无聊的坑爹，但我想有个场景可能需要用到这个。</p>
<p>在前面学习file api时，有个读取本地文件的操作，若是文件过大会很慢，不知道这个可以应用上去吗？二次学习时有必要试试。</p>
<h1>与线程进行数据交互</h1>
<p>&nbsp;我们这里完成一个功能，在前台随机生成数组，然后在后台计算能被3整出就返回前台打印：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('2882bc60-8901-4424-a681-2ac122db4157')"><img id="code_img_closed_2882bc60-8901-4424-a681-2ac122db4157" class="code_img_closed" src="43570758473519.gif" alt=""><img id="code_img_opened_2882bc60-8901-4424-a681-2ac122db4157" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2882bc60-8901-4424-a681-2ac122db4157',event)" src="16365178109279.gif" alt=""><span class="cnblogs_code_collapse">主程序</span>
<div id="cnblogs_code_open_2882bc60-8901-4424-a681-2ac122db4157" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://www.w3.org/1999/xhtml"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 6</span> <span style="background-color: #f5f5f5; color: #800000;">        span
</span><span style="color: #008080;"> 7</span>         <span style="background-color: #f5f5f5; color: #000000;">{</span>
<span style="color: #008080;"> 8</span> <span style="background-color: #f5f5f5; color: #ff0000;">            padding</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #0000ff;"> 10px</span><span style="background-color: #f5f5f5; color: #000000;">;</span>
<span style="color: #008080;"> 9</span>         <span style="background-color: #f5f5f5; color: #000000;">}</span>
<span style="color: #008080;">10</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">11</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">src</span><span style="color: #0000ff;">="../jquery-1.7.1.js"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">12</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">13</span> <span style="background-color: #f5f5f5; color: #000000;">        $(document).ready(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> () {
</span><span style="color: #008080;">14</span>             <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> worker </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #0000ff;">new</span><span style="background-color: #f5f5f5; color: #000000;"> Worker(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">t1.js</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">15</span> <span style="background-color: #f5f5f5; color: #000000;">            worker.postMessage(</span><span style="background-color: #f5f5f5; color: #000000;">''</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">16</span> <span style="background-color: #f5f5f5; color: #000000;">            worker.onmessage </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> (e) {
</span><span style="color: #008080;">17</span>                 <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> arr </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> e.data.split(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">;</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">18</span>                 <span style="background-color: #f5f5f5; color: #0000ff;">for</span><span style="background-color: #f5f5f5; color: #000000;"> (</span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> i </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">, len </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> arr.length; i </span><span style="background-color: #f5f5f5; color: #000000;">&lt;</span><span style="background-color: #f5f5f5; color: #000000;"> len; i</span><span style="background-color: #f5f5f5; color: #000000;">++</span><span style="background-color: #f5f5f5; color: #000000;">) {
</span><span style="color: #008080;">19</span>                     <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> dom </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> $(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">&lt;span&gt;</span><span style="background-color: #f5f5f5; color: #000000;">'</span> <span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;"> arr[i] </span><span style="background-color: #f5f5f5; color: #000000;">+</span> <span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">&lt;/span&gt;</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">);
</span><span style="color: #008080;">20</span> <span style="background-color: #f5f5f5; color: #000000;">                    $(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">#body</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">).append(dom);
</span><span style="color: #008080;">21</span> <span style="background-color: #f5f5f5; color: #000000;">                }
</span><span style="color: #008080;">22</span> <span style="background-color: #f5f5f5; color: #000000;">            }
</span><span style="color: #008080;">23</span> <span style="background-color: #f5f5f5; color: #000000;">        });
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">26</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">27</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">28</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">='body' </span><span style="color: #ff0000;">style</span><span style="color: #0000ff;">=' </span><span style="color: #ff0000;">width: 400px; word-break:break-all; word-wrap:break-word; '</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">29</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">30</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">31</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('3cd209ad-dfa8-46b1-8fd2-dd98d174fec2')"><img id="code_img_closed_3cd209ad-dfa8-46b1-8fd2-dd98d174fec2" class="code_img_closed" src="43570758473519.gif" alt=""><img id="code_img_opened_3cd209ad-dfa8-46b1-8fd2-dd98d174fec2" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('3cd209ad-dfa8-46b1-8fd2-dd98d174fec2',event)" src="16365178109279.gif" alt=""><span class="cnblogs_code_collapse">生成数组的程序</span>
<div id="cnblogs_code_open_3cd209ad-dfa8-46b1-8fd2-dd98d174fec2" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">onmessage = function (e) {
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;">    var arr = [];
</span><span style="color: #008080;"> 3</span>     for (var i = 0; i <span style="color: #0000ff;">&lt;</span><span style="color: #800000;"> 100</span><span style="color: #ff0000;">; i++) {
</span><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">        arr.push(parseInt(Math.random() * 100));
</span><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">    }
</span><span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> <span style="color: #ff0000;">    var worker </span><span style="color: #0000ff;">= new </span><span style="color: #ff0000;">Worker('t2.js');
</span><span style="color: #008080;"> 8</span> <span style="color: #ff0000;">    worker.postMessage(JSON.stringify(arr));
</span><span style="color: #008080;"> 9</span> <span style="color: #ff0000;">    worker.onmessage </span><span style="color: #0000ff;">= function </span><span style="color: #ff0000;">(e) {
</span><span style="color: #008080;">10</span> <span style="color: #ff0000;">        //把挑选结果发回前台
</span><span style="color: #008080;">11</span> <span style="color: #ff0000;">        postMessage(e.data);
</span><span style="color: #008080;">12</span> <span style="color: #ff0000;">    };
</span><span style="color: #008080;">13</span> <span style="color: #ff0000;">}</span></pre>
</div>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('dfb1e38a-863a-40e0-9535-a5a20b946544')"><img id="code_img_closed_dfb1e38a-863a-40e0-9535-a5a20b946544" class="code_img_closed" src="43570758473519.gif" alt=""><img id="code_img_opened_dfb1e38a-863a-40e0-9535-a5a20b946544" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('dfb1e38a-863a-40e0-9535-a5a20b946544',event)" src="16365178109279.gif" alt=""><span class="cnblogs_code_collapse">判断数组所有数据是否被3整除</span>
<div id="cnblogs_code_open_dfb1e38a-863a-40e0-9535-a5a20b946544" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">onmessage = function (e) {
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;">    var arr = JSON.parse(e.data);
</span><span style="color: #008080;"> 3</span> <span style="color: #000000;">    var str = '';
</span><span style="color: #008080;"> 4</span>     for (var i = 0, len = arr.length; i <span style="color: #0000ff;">&lt;</span><span style="color: #800000;"> len</span><span style="color: #ff0000;">; i++) {
</span><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">        if (parseInt(arr[i]) % 3 </span><span style="color: #0000ff;">== </span><span style="color: #ff0000;">0) {
</span><span style="color: #008080;"> 6</span> <span style="color: #ff0000;">            if (str !</span><span style="color: #0000ff;">= '') </span><span style="color: #ff0000;">str +</span><span style="color: #0000ff;">= ';';
</span><span style="color: #008080;"> 7</span>             <span style="color: #ff0000;">str +</span><span style="color: #0000ff;">= arr[i];
</span><span style="color: #008080;"> 8</span>         <span style="color: #ff0000;">}
</span><span style="color: #008080;"> 9</span> <span style="color: #ff0000;">    }
</span><span style="color: #008080;">10</span> <span style="color: #ff0000;">    postMessage(str);
</span><span style="color: #008080;">11</span> <span style="color: #ff0000;">    close();
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span> <span style="color: #ff0000;">};</span></pre>
</div>
</div>
<p><img src="1113159332459.jpg" alt=""></p>
<p>程序逻辑描述：</p>
<p>这里用了个线程嵌套</p>
<p>首先执行前台程序，这里初始化了一个子线程&ldquo;t1&rdquo;用于将100个数组初始化</p>
<p>然后子线程t1又初始化了子线程t2（用于遍历数组，取出能被3整除的数字，组成字符串），t1将数组数据传给t2</p>
<p>t2 接收t1数据，计算后将将字符串转给t1，t1转给前台，前台执行自己的逻辑</p>
<p>流程结束</p>
<h1>结语</h1>
<p>简单来说，我这里就是声明子线程，然后发送数据给子线postMessage，然后等待结果皆可。</p>
<p>这里看来，结合上次的通信API Web Sockets ，可以将2个结合做一个网页聊天程序，甚至还可以将本地存储/本地数据库一些东西用到。</p>
<p>这个样子可能是个不错的东西。&nbsp;</p>
<p>&nbsp;</p>
                </div>

                <div class='span3 sidebar'>
                    <h2>导航栏</h2>
                    <ul class="nav nav-tabs nav-stacked">
                             				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/CSS3ctzMediaQuerieszywcldCSS3wmlgzzzj/index.html">【CSS3初探之MediaQueries】终于完成了的CSS3，我们来个终章总结！</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/CSS3ctzbxydhlrjtdCSS3/index.html">【CSS3初探之变形与动画】令人惊叹的CSS3</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/CSS3ctzztwbxgrrkblsdCSS3/index.html">【CSS3初探之字体、文本相关】让人开不了始的CSS3。。。</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/CSS3ctzhxgyswmyrygk/index.html">【CSS3初探之盒相关样式】我们一人一个框。。。</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/CSS3ctzbjbkxgqdyldclyjqdwfzofferqdyt/index.html">【CSS3初探之背景边框相关】奇葩的与老大吵了一架，奇葩的五分钟offer，奇葩的一天。。。</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5&CSS3jjxx02HeaderdsxCSSzdbj/index.html">【HTML5&CSS3进阶学习02】Header的实现·CSS中的布局</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctzformbqjfbdyzzjwjscjctf/index.html">【HTML5初探之form标签】解放表单验证、增加文件上传、集成拖放</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctzGeolocationAPIrwmhqnsddz/index.html">【HTML5初探之GeolocationAPI】让我们获取女神的地址</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctzWebWorkerswyyndxc/index.html">【HTML5初探之WebWorkers】网页也能多线程</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctzdmtysspbfHTML5Flashscswd/index.html">【HTML5初探之多媒体元素】视频播放HTML5、Flash谁才是王道？</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctzbdccrgmysjk/index.html">【HTML5初探之本地存储】如果没有数据库。。。</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctzlxyyrhdzlqqwlldwz/index.html">【HTML5初探之离线应用】如何打造零请求、无流量的网站？</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctzhztxskwcanvasysylxydwebym/index.html">【HTML5初探之绘制图像（上）】看我canvas元素引领下一代web页面</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctzhztxxkwcanvasysylxydwebym/index.html">【HTML5初探之绘制图像（下）】看我canvas元素引领下一代web页面</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/HTML5ctztxAPIkymjbzgsjtsbsm/index.html">【HTML5初探之通信API】跨域门槛不再高、数据推送不是梦</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/xpldbkrwmdbkgjplrwmdbkzcxysbj/index.html">【写漂亮的博客】让我们的博客更加漂亮，让我们的博客支持响应式布局！</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/ctHTML5zsyxbqbjyhtml5bjwdbky/index.html">【初探HTML5之使用新标签布局】用html5布局我的博客页！</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/szHTML5yCSS3mfzzwkymlfym/index.html">【实战HTML5与CSS3】免费制作威客页面啦（附源码）</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/szHTML5yCSS3yHTML5hCSS3zzyms/index.html">【实战HTML5与CSS3】用HTML5和CSS3制作页面（上）</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/szHTML5yCSS3dypctssmlddhxldtpbz/index.html">【实战HTML5与CSS3第一篇】初探水深，美丽的导航，绚丽的图片爆炸！！</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/szHTML5yCSS3dspwdygHTML5wydsl(tgym)/index.html">【实战HTML5与CSS3第三篇】我第一个HTML5网页诞生了(提供源码)</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/szHTML5yCSS3depxldksdh/index.html">【实战HTML5与CSS3第二篇】绚丽的快速导航！</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/tsHTML5ded01HTML5dqsjsyjls/index.html">【探索HTML5第二弹01】HTML5的前世今生以及来世</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/tsHTML5ded03zjdtyydsjkwmgoogledtkykxsm/index.html">【探索HTML5第二弹03】走近地图应用的世界，看我们google地图可以看些什么！</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/tsHTML5ded04xysbjsrwmyqlxysbjb/index.html">【探索HTML5第二弹04】响应式布局（上），让我们一起来响应式布局吧</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/tsHTML5ded05xysbjzybybxysbj/index.html">【探索HTML5第二弹05】响应式布局（中），一步一步响应式布局</a></li>
    				          				<li><a href="http://songboriceboy.github.io/xxoo/html/HTML5&CSS3/rhtzCSS3ddh/index.html">如何停止CSS3的动画？</a></li>
    				                                         
                    </ul>
                </div>
            </div>

        </div>
    </body>
</html>